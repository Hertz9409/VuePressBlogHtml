(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{429:function(e,t,r){e.exports=r.p+"assets/img/1.556d1d2b.png"},430:function(e,t,r){e.exports=r.p+"assets/img/2.93b729e3.png"},431:function(e,t,r){e.exports=r.p+"assets/img/3.b19a01fe.png"},526:function(e,t,r){"use strict";r.r(t);var v=r(27),_=Object(v.a)({},(function(){var e=this,t=e.$createElement,v=e._self._c||t;return v("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[v("h1",{attrs:{id:"arcgis-task"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#arcgis-task"}},[e._v("#")]),e._v(" ArcGIS Task")]),e._v(" "),v("h2",{attrs:{id:"背景介绍"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#背景介绍"}},[e._v("#")]),e._v(" 背景介绍")]),e._v(" "),v("p",[e._v("WebGIS前端开发的核心能力就是实现"),v("code",[e._v("数据展示(map,layer)")]),e._v(","),v("code",[e._v("查询(三大查询)")]),e._v("和"),v("code",[e._v("简单分析(soe,geometryService)")]),e._v(".其中分析功能在有计算后台参与的情况下,可以交给后台通过开发SOE插件或WebAPI接口来实现,查询功能是我们前端WebGIS开发最常使用的API,在没有后台可依赖的情况下,前端要想实现服务信息的统计分析,依赖于对查询功能的灵活使用.")]),e._v(" "),v("h3",{attrs:{id:"地图服务元数据信息"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#地图服务元数据信息"}},[e._v("#")]),e._v(" 地图服务元数据信息")]),e._v(" "),v("table",[v("thead",[v("tr",[v("th",[e._v("属性名称")]),e._v(" "),v("th",[e._v("属性含义")])])]),e._v(" "),v("tbody",[v("tr",[v("td",[e._v("Spatial Reference")]),e._v(" "),v("td",[e._v("地图服务坐标系,图层坐标系")])]),e._v(" "),v("tr",[v("td",[e._v("Initial Extent")]),e._v(" "),v("td",[e._v("地图初始化范围")])]),e._v(" "),v("tr",[v("td",[e._v("Full Extent")]),e._v(" "),v("td",[e._v("地图全图范围")])]),e._v(" "),v("tr",[v("td",[e._v("Units")]),e._v(" "),v("td",[e._v("地图数据单位")])]),e._v(" "),v("tr",[v("td",[e._v("Supported Image Format Types")]),e._v(" "),v("td",[e._v("地图支持输出的图像格式")])]),e._v(" "),v("tr",[v("td",[e._v("Supports Dynamic Layers")]),e._v(" "),v("td",[e._v("支持动态修改地图图层顺序和渲染")])]),e._v(" "),v("tr",[v("td",[e._v("MaxRecordCount")]),e._v(" "),v("td",[e._v("查询一次支持最大输出要素的个数")])]),e._v(" "),v("tr",[v("td",[e._v("MaxImageHeight")]),e._v(" "),v("td",[e._v("一次请求输出的图片最大像素高度")])]),e._v(" "),v("tr",[v("td",[e._v("MaxImageWidth")]),e._v(" "),v("td",[e._v("一次请求输出的图片最大像素宽度")])]),e._v(" "),v("tr",[v("td",[e._v("Min Scale, Max Scale")]),e._v(" "),v("td",[e._v("限制比例尺,地图服务仅在此比例尺范围内可见")])]),e._v(" "),v("tr",[v("td",[e._v("Display Field")]),e._v(" "),v("td",[e._v("图层默认展示字段")])]),e._v(" "),v("tr",[v("td",[e._v("Type")]),e._v(" "),v("td",[e._v("图层类型")])]),e._v(" "),v("tr",[v("td",[e._v("Geometry Type")]),e._v(" "),v("td",[e._v("图层要素类型")])]),e._v(" "),v("tr",[v("td",[e._v("Default Visibility")]),e._v(" "),v("td",[e._v("图层是否默认可见")])]),e._v(" "),v("tr",[v("td",[e._v("Supports Statistics")]),e._v(" "),v("td",[e._v("是否支持统计查询")])]),e._v(" "),v("tr",[v("td",[e._v("Extent")]),e._v(" "),v("td",[e._v("图层数据范围")])]),e._v(" "),v("tr",[v("td",[e._v("Drawing Info")]),e._v(" "),v("td",[e._v("图层配图信息")])]),e._v(" "),v("tr",[v("td",[e._v("Fields")]),e._v(" "),v("td",[e._v("图层属性字段名称,别名,类型")])])])]),e._v(" "),v("h2",{attrs:{id:"三大查询的对比"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#三大查询的对比"}},[e._v("#")]),e._v(" 三大查询的对比")]),e._v(" "),v("table",[v("thead",[v("tr",[v("th",[e._v("API")]),e._v(" "),v("th",[e._v("说明")]),e._v(" "),v("th",[e._v("特点")]),e._v(" "),v("th",[e._v("使用场景")])])]),e._v(" "),v("tbody",[v("tr",[v("td",[e._v("QueryTask")]),e._v(" "),v("td",[e._v("对图层进行空间和属性查询的功能类")]),e._v(" "),v("td",[e._v("查询某个地图服务的某个子图层,空间查询的地图服务不必加载到Map中,返回FeatureSet结果,其中包含Graphic对象,其中属性字段key值为属性名称")]),e._v(" "),v("td",[e._v("基础查询类型,前端进行数据查询时基本都是使用此类")])]),e._v(" "),v("tr",[v("td",[e._v("IdentifyTask")]),e._v(" "),v("td",[e._v("对服务空间查询功能类")]),e._v(" "),v("td",[e._v("查询一个服务的多个图层,空间查询,返回IdentifyResults数组,其中包含Graphic对象,其中属性字段key值为属性别名")]),e._v(" "),v("td",[e._v("系统中的属性查询功能使用此类")])]),e._v(" "),v("tr",[v("td",[e._v("FindTask")]),e._v(" "),v("td",[e._v("对服务属性查询功能类")]),e._v(" "),v("td",[e._v("查询一个地图服务的多个图层的多个字段,不能进行空间查询,返回FindResults数组,其中包含Graphic对象,其中属性字段key值为属性别名")]),e._v(" "),v("td",[e._v("当实现地块查询,定位查询时,可使用此类")])])])]),e._v(" "),v("h2",{attrs:{id:"querytask-query"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#querytask-query"}},[e._v("#")]),e._v(" "),v("a",{attrs:{href:"https://developers.arcgis.com/javascript/latest/api-reference/esri-tasks-QueryTask.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("QueryTask"),v("OutboundLink")],1),e._v(", "),v("a",{attrs:{href:"https://developers.arcgis.com/javascript/latest/api-reference/esri-tasks-support-Query.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Query"),v("OutboundLink")],1)]),e._v(" "),v("p",[e._v("参数说明:")]),e._v(" "),v("ul",[v("li",[e._v("Where  "),v("code",[e._v("查询过滤SQL语句,如: 1=1, OBJECTID > 10, OBJECTID like '%11'")])]),e._v(" "),v("li",[e._v("Text  "),v("code",[e._v('模糊查询的值,查询字段为"Display Field"')])]),e._v(" "),v("li",[e._v("Object IDs  "),v("code",[e._v("ObjectID数组,返回结果从其中挑选")])]),e._v(" "),v("li",[e._v("Input Geometry  "),v("code",[e._v("查询范围")])]),e._v(" "),v("li",[e._v("Geometry Type  "),v("code",[e._v('输入范围类型:"Envelope", "Point", "Polyline", "Polygon", "MultiPoint"')])]),e._v(" "),v("li",[e._v("Input Spatial Reference  "),v("code",[e._v("输入图形坐标系")])]),e._v(" "),v("li",[e._v("Spatial Relationship  "),v("code",[e._v('定义输入范围与输出结果间的空间关系:"intersects","contains","crosses","disjoint","envelope-intersects","index-intersects","overlaps","touches","within","relation"')])]),e._v(" "),v("li",[e._v("Relation  "),v("code",[e._v("高级空间关系,使用DE-9IM九交模型矩阵表示")])]),e._v(" "),v("li",[e._v("Out Fields  "),v("code",[e._v("输出结果包含的属性字段数组,一般输入[*]表示返回所有字段")])]),e._v(" "),v("li",[e._v("Return Geometry  "),v("code",[e._v("是否返回geometry图形信息,图形信息还和发布的服务是否勾选携带图形信息(SHAPE)有关")])]),e._v(" "),v("li",[e._v("Geometry Precision  "),v("code",[e._v("返回的图形的坐标点小数位数")])]),e._v(" "),v("li",[e._v("Output Spatial Reference  "),v("code",[e._v("返回的几何图形的空间参考系")])]),e._v(" "),v("li",[e._v("Return IDs Only  "),v("code",[e._v("只返回ObjectID, 设置此参数可突破ArcGIS服务的MaxRecordCount配置")])]),e._v(" "),v("li",[e._v("Return Count Only  "),v("code",[e._v("只返回查询结果总数")])]),e._v(" "),v("li",[e._v("Order By Fields  "),v("code",[e._v("返回结果排序字段,数组可设置多个,字段后添加ASC或DESC可设置升序降序")])]),e._v(" "),v("li",[e._v("Group By Fields (For Statistics)")]),e._v(" "),v("li",[e._v("Output Statistics  "),v("code",[e._v("高级统计查询,按照配置规则,对查询结果进行统计,")]),v("a",{attrs:{href:"https://developers.arcgis.com/javascript/latest/api-reference/esri-tasks-support-Query.html#statistic",target:"_blank",rel:"noopener noreferrer"}},[e._v("参考"),v("OutboundLink")],1)]),e._v(" "),v("li",[e._v("Return Distinct Values  "),v("code",[e._v("是否返回不同的值,此参数要求Out Fields为一个字段")])]),e._v(" "),v("li",[e._v("Format  "),v("code",[e._v("返回结果格式,一般使用json")])])]),e._v(" "),v("p",[e._v("返回结果:")]),e._v(" "),v("p",[v("img",{attrs:{src:r(429),alt:"query查询返回结果"}})]),e._v(" "),v("h2",{attrs:{id:"identifytask-identifyparameters"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#identifytask-identifyparameters"}},[e._v("#")]),e._v(" "),v("a",{attrs:{href:"https://developers.arcgis.com/javascript/latest/api-reference/esri-tasks-IdentifyTask.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("IdentifyTask"),v("OutboundLink")],1),e._v(", "),v("a",{attrs:{href:"https://developers.arcgis.com/javascript/latest/api-reference/esri-tasks-support-IdentifyParameters.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("IdentifyParameters"),v("OutboundLink")],1)]),e._v(" "),v("p",[e._v("参数说明:")]),e._v(" "),v("ul",[v("li",[e._v("Geometry  "),v("code",[e._v("输入的查询范围")])]),e._v(" "),v("li",[e._v("Geometry Type  "),v("code",[e._v('输入范围类型:"Envelope", "Point", "Polyline", "Polygon"')])]),e._v(" "),v("li",[e._v("Spatial Reference  "),v("code",[e._v("输入输出以及Map Extent的空间坐标系")])]),e._v(" "),v("li",[e._v("Layers  "),v("code",[e._v("执行查询的图层数组")])]),e._v(" "),v("li",[e._v("Layer Definitions  "),v("code",[e._v("图层过滤参数,格式和地图过滤参数一致(数组-sql)")])]),e._v(" "),v("li",[e._v("Tolerance  "),v("code",[e._v("屏幕像素与查询范围间的距离,即容差")])]),e._v(" "),v("li",[e._v("Map Extent  "),v("code",[e._v("当前查询操作的地图显示范围")])]),e._v(" "),v("li",[e._v("Image Display  "),v("code",[e._v("图像长宽和dpi(1969,1062,96),此参数由arcgis api自动计算,如果我们手动进行rest请求,需要主动赋值")])]),e._v(" "),v("li",[e._v("Return Geometry  "),v("code",[e._v("返回结果是否带有几何图形")])]),e._v(" "),v("li",[e._v("Geometry Precision  "),v("code",[e._v("返回的图形的坐标点小数位数")])]),e._v(" "),v("li",[e._v("Format  "),v("code",[e._v("返回结果格式,一般使用json")])]),e._v(" "),v("li",[e._v("returnFieldName  "),v("code",[e._v("ArcGIS Server10.5新增属性,表示返回属性字段key是否为字段别名")])]),e._v(" "),v("li",[e._v("returnUnformattedValues   "),v("code",[e._v("ArcGIS Server10.5新增属性,表示返回属性字段value值是否经过格式化,如时间字段等")])])]),e._v(" "),v("p",[e._v("返回结果:")]),e._v(" "),v("p",[v("img",{attrs:{src:r(430),alt:"identify查询返回结果"}})]),e._v(" "),v("h2",{attrs:{id:"findtask-findparameters"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#findtask-findparameters"}},[e._v("#")]),e._v(" "),v("a",{attrs:{href:"https://developers.arcgis.com/javascript/latest/api-reference/esri-tasks-FindTask.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("FindTask"),v("OutboundLink")],1),e._v(", "),v("a",{attrs:{href:"https://developers.arcgis.com/javascript/latest/api-reference/esri-tasks-support-FindParameters.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("FindParameters"),v("OutboundLink")],1)]),e._v(" "),v("p",[e._v("参数说明:")]),e._v(" "),v("ul",[v("li",[e._v("Search Text  "),v("code",[e._v("搜索文本")])]),e._v(" "),v("li",[e._v("Contains  "),v("code",[e._v("是否精确匹配文本")])]),e._v(" "),v("li",[e._v("Search Fields  "),v("code",[e._v("搜索字段数组")])]),e._v(" "),v("li",[e._v("Spatial Reference  "),v("code",[e._v("返回结果空间坐标系")])]),e._v(" "),v("li",[e._v("Layers  "),v("code",[e._v("搜索图层数组")])]),e._v(" "),v("li",[e._v("Layer Definitions  "),v("code",[e._v("搜索图层过滤条件")])]),e._v(" "),v("li",[e._v("Return Geometry  "),v("code",[e._v("是否返回图形信息")])]),e._v(" "),v("li",[e._v("Geometry Precision  "),v("code",[e._v("返回的图形的坐标点小数位数")])]),e._v(" "),v("li",[e._v("Format  "),v("code",[e._v("返回结果格式,一般使用json")])])]),e._v(" "),v("p",[e._v("返回结果:")]),e._v(" "),v("p",[v("img",{attrs:{src:r(431),alt:"find查询返回结果"}})]),e._v(" "),v("h2",{attrs:{id:"printtask"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#printtask"}},[e._v("#")]),e._v(" "),v("a",{attrs:{href:"http://52.82.98.186:6080/arcgis/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task",target:"_blank",rel:"noopener noreferrer"}},[e._v("PrintTask"),v("OutboundLink")],1)]),e._v(" "),v("p",[e._v("ArcGIS Server自带一个地图打印服务,通过这个服务,我们可以实现地图数据的高清打印.")]),e._v(" "),v("p",[e._v("优点:")]),e._v(" "),v("ul",[v("li",[e._v("使用地图打印服务,可以实现数据的高清打印,dpi可手动设置")]),e._v(" "),v("li",[e._v("代码逻辑简单,服务器性能好,效率高")])]),e._v(" "),v("p",[e._v("缺点:")]),e._v(" "),v("ul",[v("li",[e._v("需要预先使用ArcGIS Desktop制作地图出图模板,对实施人员水平有一定要求")]),e._v(" "),v("li",[e._v("预留参数和制图元素较少,不能实现各种个性化出图(只有标题,作者,版权,图例,比例尺,指北针等制图组件)")]),e._v(" "),v("li",[e._v("一些丰富的专题图输出不能实现")])]),e._v(" "),v("p",[e._v("目前前端实现界面出图功能都是通过canvas实现的,在ArcGIS的3.xAPI中,地图数据通过img节点渲染,此时使用canvas时会存在跨域问题,我们也经过多次探索,勉强解决了问题.")]),e._v(" "),v("p",[e._v("现在的4.xAPI中,地图数据完全渲染在canvas中,前端天然就支持直接进行图片导出,所以MapView的类中能够直接提供takeScreenshot方法来实现地图截图导出.")]),e._v(" "),v("p",[e._v("并且OpenLayer等开源WebGIS平台也使用canvas渲染地图,在这样的大背景下,我们基本不再使用PrintTask来实现地图导出,而是前端直接使用canvas导出,这样做不仅可以快速导出,而且可以实现更多丰富的效果.")]),e._v(" "),v("h2",{attrs:{id:"soe-server-object-extensions"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#soe-server-object-extensions"}},[e._v("#")]),e._v(" "),v("a",{attrs:{href:"https://developers.arcgis.com/rest/services-reference/service-extension.htm",target:"_blank",rel:"noopener noreferrer"}},[e._v("SOE -- server object extensions"),v("OutboundLink")],1)]),e._v(" "),v("p",[e._v("SOE服务是ArcGIS Server服务的扩展,旨在将ArcGIS Desktop强大的分析能力带到服务中来,从而实现web端的实时分析.目前SOE服务由计算团队开发维护,以rest服务接口的形式展现.")]),e._v(" "),v("p",[e._v("当前端查询分析能力存在瓶颈或者效率低下时,可借助服务器强大的性能以及可以直接读取空间数据库表的能力,利用SOE服务来实现数据分析.")]),e._v(" "),v("p",[e._v("SOE服务在实践过程中也发现一些问题,如假死,只能挂载在一个服务上并只能读取挂载的服务的数据等")]),e._v(" "),v("h2",{attrs:{id:"总结"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[e._v("#")]),e._v(" 总结")]),e._v(" "),v("p",[e._v("本节主要介绍了ArcGIS中的三大查询,地图打印服务和SOE服务,其中地图打印服务已很少使用,SOE服务就是普通的REST服务接口,直接ajax调用就可以.主要是三大查询,要理解各自的特点以及使用场景,在具体的业务中可以灵活选用.")])])}),[],!1,null,null,null);t.default=_.exports}}]);